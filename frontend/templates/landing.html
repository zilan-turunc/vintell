<!DOCTYPE html>
<html>
<head>
    <title>Vintell AI</title>
    <style>
        body { font-family: sans-serif; text-align: center; padding: 50px; background-color: #f4f4f9; color: #333; }
        h1 { color: #4a4a4a; }
        h2 { color: #5a5a5a; }
        .container { max-width: 700px; margin: auto; background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .section { margin: 40px 0; border-top: 1px solid #eee; padding-top: 30px; }
        textarea, input[type="text"] { padding: 12px; width: 80%; border: 1px solid #ddd; border-radius: 4px; font-size: 16px; margin-bottom: 10px; }
        input[type="file"] { display: block; margin: 15px auto; }
        button { background-color: #5c67f2; color: white; padding: 12px 22px; margin-top: 10px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; transition: background-color 0.3s; }
        button:hover { background-color: #4a54e1; }
        button:disabled { background-color: #ccc; }
        pre { background-color: #f8f8f8; border: 1px solid #ddd; padding: 15px; border-radius: 4px; text-align: left; white-space: pre-wrap; word-wrap: break-word; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ§  Vintell AI Assistant</h1>

        <div class="section">
            <h2>RAG Document Query (Streaming)</h2>
            <form id="rag-form">
                <input type="text" id="rag-query" placeholder="e.g. What are the latest fashion trends?" required/><br>
                <button type="submit" id="rag-submit">Ask RAG</button>
            </form>
            <pre id="rag-output" style="margin-top: 20px; min-height: 100px;"></pre>
        </div>

        <div class="section">
            <h2>Image Similarity Search</h2>
            <form action="/image-search" method="post" enctype="multipart/form-data">
                <p style="font-size: 0.9em; color: #666;">Upload an image to find similar items.</p>
                <input type="file" name="image_file" accept="image/*" required><br>
                <button type="submit">Find Similar Images</button>
            </form>
        </div>

        <div class="section">
            <h2>Text-to-Fashion Recommender</h2>
            <form action="/text-to-fashion" method="post">
                <textarea name="description" placeholder="e.g. black crop top with lace" required></textarea><br>
                <button type="submit">Suggest Items</button>
            </form>
        </div>

        <div class="section">
            <h2>Moodboard Hashtag Generator</h2>
            <form action="/moodboard-tags" method="post">
                <input type="text" name="style_description" placeholder="e.g. red blouse" required/><br>
                <button type="submit">Generate Tags</button>
            </form>
        </div>
    </div>

<script>
    const ragForm = document.getElementById('rag-form');
    const ragQuery = document.getElementById('rag-query');
    const ragOutput = document.getElementById('rag-output');
    const ragSubmit = document.getElementById('rag-submit');

    ragForm.addEventListener('submit', async (event) => {
        event.preventDefault();
        const query = ragQuery.value;
        if (!query) return;

        ragOutput.textContent = 'Thinking...';
        ragSubmit.disabled = true;

        const eventSource = new EventSource(`/rag-stream-proxy?q=${encodeURIComponent(query)}`);

        eventSource.onopen = () => {
            ragOutput.textContent = '';
        };
        
        eventSource.addEventListener('token', (e) => {
            ragOutput.textContent += e.data;
        });

        eventSource.addEventListener('done', (e) => {
            eventSource.close();
            ragSubmit.disabled = false;
        });

        eventSource.onerror = (err) => {
            console.error("EventSource failed:", err);
            ragOutput.textContent += '\n\nError connecting to the stream.';
            eventSource.close();
            ragSubmit.disabled = false;
        };
    });
</script>

</body>
</html>